import{e as R,r as i,f as w,h as U,q as v,o as u,c as f,a3 as A,a4 as J,b as W,m as V,F as G,i as Q,j as M,C as T,t as D,w as z,l as X,J as Z,ax as ee,H as F,ar as L,ay as ae,_ as te}from"./index-9e436c07.js";import{d as le}from"./search-cc37b371.js";const ve={width:1024,height:1024,body:'<path fill="currentColor" d="M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"/>'},fe={width:1024,height:1024,body:'<path fill="currentColor" d="m199.04 672.64l193.984 112l224-387.968l-193.92-112l-224 388.032zm-23.872 60.16l32.896 148.288l144.896-45.696L175.168 732.8zM455.04 229.248l193.92 112l56.704-98.112l-193.984-112l-56.64 98.112zM104.32 708.8l384-665.024l304.768 175.936L409.152 884.8h.064l-248.448 78.336L104.32 708.8zm384 254.272v-64h448v64h-448z"/>'},ne={class:"filter-field border-line"},oe={key:0},se={key:1},re={key:2},ue={key:0,class:"filterTitle"},ce=R({name:"MySearch",__name:"index",props:{placeholder:{type:String,default:"请输入搜索内容"},searchField:{type:String,default:"search"},searchOptions:{type:Array,default:()=>[]},queryParams:{type:Object,default:()=>({})}},emits:["tagSearch"],setup(y,{emit:h}){const s=y,B=[{text:"上周",value:()=>{const e=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*7),[a,e]}},{text:"上个月",value:()=>{const e=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*30),[a,e]}},{text:"最近3个月",value:()=>{const e=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*90),[a,e]}}],p=i("xxx"),x=i(),Y=i(),m=i(!1),l=i(""),g=i(""),t=i(""),c=i(s.queryParams||{}),b=w(()=>{if(!l.value)return"";for(const e of s.searchOptions)if(e.value===l.value)return e==null?void 0:e.label;return""}),d=w(()=>{const e={};for(let a in c.value){const n=c.value[a].value;a===""&&(a=s.searchField),a.startsWith(s.searchField)?e[s.searchField]=(e[s.searchField]?e[s.searchField]+",":"")+n:e[a]=n}return e}),I=w(()=>m.value&&l.value?"按下Enter键进行搜索":s.placeholder);U(()=>{if(!Object.keys(s.queryParams).length)return;const e=setTimeout(()=>{Object.keys(d).length>0&&h("tagSearch",d.value),clearTimeout(e)},500)});const $=(e,a)=>{for(const n of s.searchOptions)if(!(n.value!==e||!n.children)){for(const r of n.children)if(r.value===a)return r.label}return""},j=e=>{!e||e.length===0||(e.length===1?(e[0].indexOf("date")>-1&&(p.value="date"),l.value=e[0],x.value.focus()):e.length===2&&(l.value=e[0],t.value=e[1],g.value=$(e[0],e[1]),_()),F(()=>{var a,n;(n=(a=Y.value)==null?void 0:a.cascaderPanelRef)==null||n.clearCheckedNodes()}))},H=e=>{delete c.value[e],h("tagSearch",d.value)},q=()=>{m.value=!1,O(t.value)},O=e=>{const a=L(e[0]).format("YYYY-MM-DD"),n=L(e[1]).format("YYYY-MM-DD");t.value=a+" ~ "+n;const r={key:l.value,label:b.value,value:t.value,valueLabel:g.value};c.value[l.value]=r,h("tagSearch",d.value),l.value="",t.value="",g.value="",p.value="xxx"},_=()=>{if(t.value===""){delete c.value[l.value],l.value="",h("tagSearch",d.value);return}t.value&&!l.value&&(l.value=s.searchField+"_"+t.value);const e={key:l.value,label:b.value,value:t.value,valueLabel:g.value};c.value[l.value]=e,h("tagSearch",d.value),l.value="",t.value="",g.value=""},E=(e,a)=>{let n=!1;for(const r of s.searchOptions)r.value===a.key&&r.readonly&&(n=!0);if(n){ae({message:"当前选项不可编辑",type:"warning"});return}if(t.value.length!==0&&_(),delete c.value[e],l.value=a.key,e.toString().indexOf("date")>-1){p.value="date";const r=a.value.split("~"),S=r[0].toString().trim(),k=r[0].toString().trim();t.value=[new Date(S),new Date(k)]}else p.value="xxx",t.value=a.value;F(()=>{x.value.focus()})};return(e,a)=>{const n=v("el-cascader"),r=v("el-tag"),S=v("IconifyIconOffline"),k=v("el-icon"),K=v("el-input"),N=v("el-date-picker");return u(),f("div",ne,[A(W("div",null,[V(n,{ref_key:"CascaderRef",ref:Y,options:y.searchOptions,props:{expandTrigger:"hover"},onChange:j},null,8,["options"])],512),[[J,y.searchOptions.length>0]]),(u(!0),f(G,null,Q(c.value,(o,C)=>(u(),M(r,{key:C,name:C,closable:"",size:"small",class:"filter-tag",type:"info","disable-transitions":!0,onClose:P=>H(C),onClick:P=>E(C,o)},{default:T(()=>[o.label?(u(),f("strong",oe,D(o.label+":"),1)):z("",!0),o.valueLabel?(u(),f("span",se,D(o.valueLabel),1)):(u(),f("span",re,D(o.value),1))]),_:2},1032,["name","onClose","onClick"]))),128)),b.value?(u(),f("span",ue,D(b.value+":"),1)):z("",!0),p.value!=="date"?(u(),M(K,{key:1,ref_key:"SearchInput",ref:x,modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value=o),placeholder:I.value,class:Z(["search-input",y.searchOptions.length<1?"search-input2":""]),"validate-event":!1,format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onBlur:a[1]||(a[1]=o=>m.value=!1),onFocus:a[2]||(a[2]=o=>m.value=!0),onChange:_,onKeyup:ee(_,["enter"])},{suffix:T(()=>[V(k,{class:"el-input__icon",onClick:_},{default:T(()=>[V(S,{icon:X(le)},null,8,["icon"])]),_:1})]),_:1},8,["modelValue","placeholder","class","onKeyup"])):(u(),M(N,{key:2,ref_key:"SearchInput",ref:x,modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value=o),type:"daterange","unlink-panels":"","range-separator":"~","start-placeholder":"开始时间","end-placeholder":"结束时间",shortcuts:B,size:"default",onBlur:q,onFocus:a[4]||(a[4]=o=>m.value=!0),onChange:O,style:{width:"240px"},clearable:""},null,8,["modelValue"]))])}}});const he=te(ce,[["__scopeId","data-v-6eb9dea4"]]);export{he as B,ve as a,fe as d};
